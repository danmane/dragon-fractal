<head>
  <meta charset="UTF-8">
  <script src="bower_components/d3/d3.js"></script>
</head>
<body>
  <style>
    #main {
      width: 600px;
      height: 600px;
      border: 1px solid blue;
      margin: 50px;
    }
    path {
      stroke: black;
    }
    body {
      margin: 0;
    }
  </style>
  <svg id="main">
    <g id="origin" transform="translate(300, 300)">
    </g>
  </svg>
  <button id="update">Update</button>
  <button id="reset">Reset</button>
  <script>
  origin = d3.select("#origin");
  function reset() {
    x=50, y=0, id=0;
    origin.node().innerHTML = '<path id="0" d="M 0 0 L ' + x + ' 0" />';
  }
  reset()
  function update() {
    var g = origin.append("g").attr("id", id+1)
    g.append("use").attr("xlink:href", "#" + id);
    start = "rotate(0 " + [x,y] + ")", end = "rotate(90 " + [x,y] + ")";
    rotate = g.append("g").attr("transform", start)
    tween = function() {return d3.interpolateString(start,end)}
    rotate.transition().duration(1200).attrTween("transform", tween);
    console.log("transition from ", start, "to", end)
    rotate.append("use").attr("xlink:href", "#" + id);
    id++, _x = x+y, y = -x+y, x = _x;
  }

  document.getElementById("update").onclick = update
  document.getElementById("reset").onclick = reset
  </script>
</body>
